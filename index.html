<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>1.3</title>
  <style>
    body {
      margin: 0;
      background-color: black;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
      position: relative;
    }

    .slide {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: none;
    }

    img {
      width: 100%;
      height: auto;
    }

    .iframe-wrapper {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      display: none;
      justify-content: center;
      align-items: center;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>

  <!-- Картинка -->
  <img id="imageSlide" class="slide" src="image.jpg" alt="Логотип">

  <!-- Видео через iframe -->
  <div id="videoSlide" class="iframe-wrapper">
    <iframe id="vkVideo"
            src=""
            allow="autoplay; fullscreen; picture-in-picture"
            allowfullscreen>
    </iframe>
  </div>

  <script>
    const image = document.getElementById('imageSlide');
    const videoWrapper = document.getElementById('videoSlide');
    const iframe = document.getElementById('vkVideo');

    // Прямые ссылки
    const imageUrl = 'image.jpg';
    const videoUrl = 'https://vkvideo.ru/video_ext.php?oid=66807882&id=456239179&hd=2&autoplay=1 ';

    function showImage() {
      videoWrapper.style.display = 'none';
      image.style.display = 'block';

      setTimeout(() => {
        image.style.display = 'none';
        iframe.src = videoUrl;
        videoWrapper.style.display = 'flex';
      }, 15000); // показываем картинку 15 секунд
    }

    // Чтобы обнаружить окончание видео — используем setInterval
    function startPollingForEnd() {
      const checkIframe = () => {
        try {
          if (!iframe.contentWindow) return;

          iframe.contentWindow.postMessage(
            JSON.stringify({
              method: 'isPaused'
            }),
            '*'
          );
        } catch (e) {
          console.warn('Ошибка доступа к iframe');
        }
      };

      setInterval(checkIframe, 2000);
    }

    // Обработка завершения видео (примерная)
    window.addEventListener('message', function(event) {
      try {
        const data = JSON.parse(event.data);

        // Если видео остановлено/закончилось — перезапускаем цикл
        if (data && data.isPaused === true) {
          iframe.src = '';
          videoWrapper.style.display = 'none';
          showImage();
        }
      } catch (e) {
        // Не все сообщения — от видео
      }
    });

    // Начинаем с картинки
    showImage();

    // Можно добавить polling для отслеживания конца видео
    // startPollingForEnd();
  </script>

</body>
</html>
